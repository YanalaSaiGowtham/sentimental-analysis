# -*- coding: utf-8 -*-
"""Template_SentimentAnalysisGDC.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/19w1f8Oo4wGELLe8wUcBVuv36gXNll4nf
"""

!pip install azure-ai-textanalytics==5.2.0
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

from azure.ai.textanalytics import TextAnalyticsClient
from azure.core.credentials import AzureKeyCredential
language_key = ""
language_endpoint = ""
ta_credential = AzureKeyCredential(language_key)
text_analytics_client = TextAnalyticsClient(endpoint=language_endpoint, credential=ta_credential)
client = text_analytics_client

from google.colab import drive
drive.mount('/content/drive')

file_path = '/content/drive/MyDrive/Colab Notebooks/V2updated_game_day_datachargers.csv'

df = pd.read_csv(file_path)
# df

def analyze_sentiment(row):
    text = row["text"]
    result = text_analytics_client.analyze_sentiment(documents=[text])[0]
    sentiment = result.sentiment
    positive_score = result.confidence_scores.positive
    negative_score = result.confidence_scores.negative
    neutral_score = result.confidence_scores.neutral
    return pd.Series([sentiment, positive_score, negative_score, neutral_score],
                     index=["sentiment", "positive_score", "negative_score", "neutral_score"])
    

df = df[150000:250000]

# Apply sentiment analysis function to each row and merge with original DataFrame
df = pd.concat([df, df.apply(analyze_sentiment, axis=1)], axis=1)

# Save results to CSV file
df.to_csv("/content/drive/MyDrive/Colab Notebooks/sentiment_analysis_results_60k_to_500k.csv", index=False)
